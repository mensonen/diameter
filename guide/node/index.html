
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../message/">
      
      
        <link rel="next" href="../application/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.1">
    
    
      
        <title>Connecting to peers - Python Diameter Stack</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
    

    

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#connecting-to-diameter-peers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Python Diameter Stack" class="md-header__button md-logo" aria-label="Python Diameter Stack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Diameter Stack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Connecting to peers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mensonen/diameter" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Python Diameter Stack" class="md-nav__button md-logo" aria-label="Python Diameter Stack" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Python Diameter Stack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mensonen/diameter" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with AVPs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../message/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with messages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Connecting to peers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Connecting to peers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#diameter-node" class="md-nav__link">
    <span class="md-ellipsis">
      Diameter Node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diameter Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-client-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic client usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-a-server" class="md-nav__link">
    <span class="md-ellipsis">
      Starting a server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Node attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diameter-peer" class="md-nav__link">
    <span class="md-ellipsis">
      Diameter peer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diameter peer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peer-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Peer attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peer-connection-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Peer connection attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-messages-through-a-peer" class="md-nav__link">
    <span class="md-ellipsis">
      Sending messages through a peer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sample_application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/credit_control_sms_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credit Control SMS client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/idle_server_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Idling server and client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Refrence
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Refrence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api/avp/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    AVP
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            AVP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/avp/grouped/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grouped AVPs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/message/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Message
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/aa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/aa_mobile_node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AA Mobile Node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/abort_session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abort Session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/accounting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accounting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/capabilities_exchange/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capabilities Exchange
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/credit_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Credit Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/device_watchdog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Device Watchdog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/diameter_eap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diameter EAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/disconnect_peer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disconnect Peer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/re_auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Re Auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/session_termination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session Termination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/commands/other_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/peer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="connecting-to-diameter-peers">Connecting to Diameter Peers<a class="headerlink" href="#connecting-to-diameter-peers" title="Permanent link">&para;</a></h1>
<p>The <code>diameter</code> package provides tools to connect to multiple diameter peers 
within the same diameter realm, with automated CER/CEA, DWR/DWA and DPR/DPA 
handling, as well as message routing to local applications.</p>
<p>The diameter node implementation supports both TCP and SCTP transports. It does
not support secure transports.</p>
<h2 id="diameter-node">Diameter Node<a class="headerlink" href="#diameter-node" title="Permanent link">&para;</a></h2>
<p>A diameter node represents the local diameter peer. It can be either a server,
or a client, with the only difference being in the applications that want to 
receive requests (server) and applications that want to send requests (client)
through the node.</p>
<p>In both cases, the diameter node is the same, and it will handle messages 
flowing in both directions.</p>
<h3 id="basic-client-usage">Basic client usage<a class="headerlink" href="#basic-client-usage" title="Permanent link">&para;</a></h3>
<p>A basic node that acts as a client is constructed with <a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.Node"><code>Node</code></a>.</p>
<div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-0-2">
</span><span id="__span-0-3"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>A client node with no other arguments than the origin host and the local realm
name will connect to any other peer and will advertise support for every vendor
known to the <code>diameter</code> package. If necessary, the list of advertised vendors
can be limited with:</p>
<div class="highlight"><pre><span></span><code><span id="__span-1-1"><span class="kn">from</span> <span class="nn">diameter.message.constants</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-1-2"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span>
</span><span id="__span-1-5">            <span class="n">vendor_ids</span><span class="o">=</span><span class="p">[</span><span class="n">VENDOR_ETSI</span><span class="p">,</span> <span class="n">VENDOR_TGPP</span><span class="p">,</span> <span class="n">VENDOR_TGPP2</span><span class="p">])</span>
</span></code></pre></div>
<p>A node will only establish outgoing connections to known peers. Each peer must
be added individually:</p>
<div class="highlight"><pre><span></span><code><span id="__span-2-1"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-2-2">
</span><span id="__span-2-3"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">)</span>
</span><span id="__span-2-4"><span class="n">node</span><span class="o">.</span><span class="n">add_peer</span><span class="p">(</span><span class="s2">&quot;aaa://ocs1.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span> 
</span><span id="__span-2-5">              <span class="n">ip_addresses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.16.0.7&quot;</span><span class="p">])</span>
</span><span id="__span-2-6"><span class="n">node</span><span class="o">.</span><span class="n">add_peer</span><span class="p">(</span><span class="s2">&quot;aaa://ocs2.gy;transport=sctp&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span> 
</span><span id="__span-2-7">              <span class="n">ip_addresses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.16.0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;10.16.5.8&quot;</span><span class="p">],</span> <span class="n">is_persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p>Adding a peer as <code>persistent</code> will result in the node establishing an outgoing 
connection at startup and ensuring that the connection remains up, by means of
reconnecting after connection loss, if necessary. A peer that is not set as 
persistent will never be automatically connected to. A reconnect attempt is 
<em>not</em> made, if the peer has been disconnected after a successful 
"Disconnect-Peer-Request". This can be overridden by setting the 
<a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.Peer.always_reconnect"><code>always_reconnect</code></a> attribute to 
true.</p>
<p>Adding a peer without specifying its ip addresses will only make the peer 
"known"; no outgoing connection is ever attempted and the initial connection 
must be made by the peer themselves, towards our node (for this the node must 
<a href="#starting-a-server">act as a server</a>).</p>
<p>Peers must be added using a "DiameterURI" syntax, consisting of a scheme, peer
FQDN, a connection port and transport protocol. Valid URIs are for instance:</p>
<ul>
<li>aaa://node1.gy;3868;transport=tcp</li>
<li>aaa://node1.gy.realm.net;9009;transport=sctp</li>
</ul>
<p>If not specified, a peer defaults <code>tcp</code> over  port <code>3868</code>. Whether the
realm FQDN should contain also the realm name or not, depends on how the peer
on the receiving side of the connection is configured.</p>
<p>A <a class="autorefs autorefs-internal" href="../../api/utilities/#diameter.node.parse_diameter_uri">utility function</a> exists for parsing the
"DiameterURI" syntax.</p>
<p>After one or more peers have been configured, the node must be started with 
<a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.Node.start"><code>start</code></a> and stopped with 
<a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.Node.stop"><code>stop</code></a>. When started, the node will establish an 
outgoing connection with every connected peer and perform a CER/CEA message 
exchange. When asked to stop, the node sends a DPR (Disconnect-Peer-Request) 
towards every connected peer and ends its operations as soon as a 
DPA (Disconnect-Peer-Answer) has been received from every peer.</p>
<div class="highlight"><pre><span></span><code><span id="__span-3-1"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-3-2">
</span><span id="__span-3-3"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="__span-3-5"><span class="c1"># wait</span>
</span><span id="__span-3-6"><span class="n">node</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">wait_timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<p>Starting the node will spawn a thread in the background, i.e. <code>node.start()</code>
will not block.</p>
<p>The stop command has optional timeout and force arguments; the timeout argument
controls how long the node should wait for DPAs to arrive and for the peer 
connections to empty their outgoing message buffers before giving up and 
exiting. The force argument will just close all connections without even 
sending out DPRs first.</p>
<p>For sending diameter messages through the node, see 
<a href="../application/">writing diameter applications</a>.</p>
<h3 id="starting-a-server">Starting a server<a class="headerlink" href="#starting-a-server" title="Permanent link">&para;</a></h3>
<p>Operating a node as a server is near-identical to starting a node as a client.
The only difference is, that a server will also be listening for incoming 
connections on local socket(s):</p>
<div class="highlight"><pre><span></span><code><span id="__span-4-1"><span class="kn">from</span> <span class="nn">diameter.message.constants</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-4-2"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-4-3">
</span><span id="__span-4-4"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span>
</span><span id="__span-4-5">            <span class="n">ip_addresses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.17.20.9&quot;</span><span class="p">,</span> <span class="s2">&quot;172.16.13.9&quot;</span><span class="p">],</span>
</span><span id="__span-4-6">            <span class="n">tcp_port</span><span class="o">=</span><span class="mi">3868</span><span class="p">,</span>
</span><span id="__span-4-7">            <span class="n">sctp_port</span><span class="o">=</span><span class="mi">3868</span><span class="p">,</span>
</span><span id="__span-4-8">            <span class="n">vendor_ids</span><span class="o">=</span><span class="p">[</span><span class="n">VENDOR_ETSI</span><span class="p">,</span> <span class="n">VENDOR_TGPP</span><span class="p">,</span> <span class="n">VENDOR_TGPP2</span><span class="p">])</span>
</span><span id="__span-4-9"><span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></code></pre></div>
<p>The node can handle both TCP and SCTP transports simultaneously. More than one
IP address can be provided for SCTP multi-homing. The same address list is 
used for both TCP and SCTP. If more than one address is provided and only a 
<code>tcp_port</code> is given, the node will only listen on the first address of the list.
TCP will also always use the first address provided.</p>
<p>For sending and receiving diameter messages through the node, see 
<a href="../application/">writing diameter applications</a>.</p>
<h3 id="node-attributes">Node attributes<a class="headerlink" href="#node-attributes" title="Permanent link">&para;</a></h3>
<p>A node has several attributes that can be used or altered after its creation:</p>
<dl>
<dt><code>vendor_id</code></dt>
<dd>The vendor ID that node will advertise in every CER and CEA. Defaults to 
99999, i.e. "Unknown". Can be changed at any time, though preferably before
<code>Node.start()</code> is called.</dd>
<dt><code>product_name</code></dt>
<dd>The product name that the noed will advertise in CER and CEA. Defaults to 
"python-diameter". Can be changed at any time, though preferably before
<code>Node.start()</code> is called.</dd>
<dt><code>cea_timeout</code></dt>
<dd>Default time in seconds that the node will wait for a CEA to arrive after
sending a CER. This can also be set individually for each peer.</dd>
<dt><code>cer_timeout</code></dt>
<dd>Default time in seconds that the node will wait for a CER to arrive after
a connection attempt is received. This can also be set individually for 
each peer.</dd>
<dt><code>dwa_timeout</code></dt>
<dd>Default time in seconds that the node will wait for a DWA to arrive after
a DWR has been sent. This can also be set individually for each peer.</dd>
<dt><code>idle_timeout</code></dt>
<dd>Default time of peer inactivity, in seconds that the node will accept 
before a DWR will be sent. This can also be set individually for each peer.</dd>
<dt><code>wakeup_interval</code></dt>
<dd>
<p>Time in seconds between forced wakeups while waiting for connection
sockets to become active. This timer value controls how often peer 
timers are checked, how often reconnects are attempted and how often 
statistics are dumped in the logfiles. </p>
<p>As this also defines the interval at which peer timers are checked, it 
is also the smallest possible value for a peer timer value. Setting 
this value very low will consume more CPU, setting it too high will 
make observing short timeouts impossible.</p>
<p>This value also defines how long a node will continue to run, after 
<code>stop</code> with <code>force</code> argument set to <code>True</code> is called.</p>
</dd>
<dt><code>peers_logging</code></dt>
<dd>If enabled, will dump a JSON representation of each peer configuration and 
their current connection status, at every <code>wakeup_interval</code> seconds. The 
logging will be done through "diameter.stats" log facility and can also be 
silenced by changing the log level to anything above DEBUG.</dd>
<dt><code>stats_logging</code></dt>
<dd>If enabled, will dump a JSON representation of the statistics for each peer 
in the logs, at every <code>wakeup_interval</code> seconds. The logging will be done 
through "diameter.stats" log facility and can also be silenced by changing 
the log level to anything above DEBUG. Enabling this may have a slight 
performance impact, as the main thread will block while the statistics are 
being gathered.</dd>
<dt><code>end_to_end_seq</code></dt>
<dd>
<p>The end-to-end identifier generator. This must be used every time a new 
request message is to be sent through the node:</p>
<div class="highlight"><pre><span></span><code><span id="__span-5-1"><span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
</span><span id="__span-5-2"><span class="n">m</span> <span class="o">=</span> <span class="n">Message</span><span class="p">()</span>
</span><span id="__span-5-3"><span class="n">m</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end_to_end_identifier</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">end_to_end_seq</span><span class="o">.</span><span class="n">next_sequence</span><span class="p">()</span>
</span></code></pre></div>
<p>Note that when working with <a href="../application/">applications</a>, the end-to-end 
identifier will be set automatically for every outgoing request.</p>
</dd>
<dt><code>session_generator</code></dt>
<dd>
<p>A generator that produces "globally and eternally unique" IDs, as required
by rfc6733. The produced session IDs consist of the node's diameter 
identity, a node startup timestamp and a 64-bit counter that is increased by
one for each session ID and is initialised to a random integer at node 
startup.</p>
<div class="highlight"><pre><span></span><code><span id="__span-6-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;test1.gy&quot;</span><span class="p">)</span>
</span><span id="__span-6-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">session_generator</span><span class="o">.</span><span class="n">next_id</span><span class="p">()</span>
</span><span id="__span-6-3"><span class="go">test1.gy;6571a525;5bd295f2;6c76d6b6</span>
</span><span id="__span-6-4"><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">session_generator</span><span class="o">.</span><span class="n">next_id</span><span class="p">()</span>
</span><span id="__span-6-5"><span class="go">test1.gy;6571a525;5bd295f2;6c76d6b7</span>
</span></code></pre></div>
</dd>
<dt><code>peers</code></dt>
<dd>Contains a dictionary of all peers known to the node, both those that have 
been configured manually using <code>add_peer</code> and those that have been 
discovered. The dictionary holds host identities as strings as its keys and
instances of <a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.Peer"><code>Peer</code></a> as its values.</dd>
<dt><code>statistics</code></dt>
<dd>Returns an instance of <a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.NodeStats"><code>NodeStats</code></a>, which 
contains statistical values, cumulated over every configured peer, at the
time of retrieval.</dd>
<dt><code>statistics_history</code></dt>
<dd>A list of dictionaries, each representing a serialised snapshot of a 
<a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.NodeStats"><code>NodeStats</code></a> instance, retrieved every 60 
seconds since the node startup, rotating at 1440 minutes. The historical 
statistics values are preserved over node restarts, but only stored in 
memory.</dd>
</dl>
<h2 id="diameter-peer">Diameter peer<a class="headerlink" href="#diameter-peer" title="Permanent link">&para;</a></h2>
<p>An instance of <a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.Peer"><code>Peer</code></a> represents a single diameter
peer in the realm, other than the local node. The local diameter node collects 
one instance of <code>Peer</code> for each connection that it either makes, receives, will 
connect to, or will accept a connection from.</p>
<p>An instance of a peer is returned every time 
<a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.Node.add_peer"><code>Node.add_peer</code></a> is called:</p>
<div class="highlight"><pre><span></span><code><span id="__span-7-1"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-7-2">
</span><span id="__span-7-3"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">)</span>
</span><span id="__span-7-4"><span class="n">peer</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_peer</span><span class="p">(</span><span class="s2">&quot;aaa://ocs2.gy;transport=sctp&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span> 
</span><span id="__span-7-5">                     <span class="n">ip_addresses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.16.0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;10.16.5.8&quot;</span><span class="p">])</span>
</span></code></pre></div>
<p>A configured peer can be passed on to <a href="../application/">a diameter application</a>. </p>
<p>A peer may be configured with a realm other than the Node and multiple realms
with various realms may coexist.</p>
<p>An instance of a peer will exist always, whether the peer is connected or not.
The connectivity of the peer is indicated by the 
<a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.Peer.connection"><code>Peer.connection</code></a> instance attribute, 
which holds an instance of a <a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.PeerConnection"><code>PeerConnection</code></a> 
if the peer is currently connected, otherwise <code>None</code>.</p>
<h3 id="peer-attributes">Peer attributes<a class="headerlink" href="#peer-attributes" title="Permanent link">&para;</a></h3>
<p>Peers have several attributes that can be queried and/or altered after creation:</p>
<dl>
<dt><code>cea_timeout</code></dt>
<dd>Time in seconds that the node will wait for a CEA to arrive for the peer 
after sending a CER. Not set by default, uses the values configured for the
node.</dd>
<dt><code>cer_timeout</code></dt>
<dd>Default time in seconds that the node will wait for a CER to arrive for
the peer after a connection attempt is received.  Not set by default, uses 
the values configured for the node.</dd>
<dt><code>dwa_timeout</code></dt>
<dd>Default time in seconds that the node will wait for a DWA to arrive for the
peer after a DWR has been sent. Not set by default, uses the values 
configured for the node.</dd>
<dt><code>idle_timeout</code></dt>
<dd>Time of peer inactivity, in seconds that the node will accept before a DWR 
will be sent. Not set by default, uses the values configured for the node.</dd>
<dt><code>always_reconnect</code></dt>
<dd>Force a persistent peer to always reconnect after connection loss, even if
the peer has closed its connection after a successful 
"Disconnect-Peer-Request" exchange. Defaults to <code>false</code>.</dd>
<dt><code>reconnect_wait</code></dt>
<dd>Time to wait before attempting a re-connect for a persistent peer. Must be
set individually for each peer, there are no default values provided by the
node.</dd>
<dt><code>connection</code></dt>
<dd>An instance of <code>PeerConnection</code>, if the peer is currently connected.</dd>
<dt><code>last_connect</code></dt>
<dd>A unix timestamp indicating when the peer was last time successfully
connected. The timestamp is set for outgoing connections at the time the
socket is established and of incoming connections when a CER has been
received.</dd>
<dt><code>last_disconnect</code></dt>
<dd>A unix timestamp indicating when the peer was last disconnected.</dd>
<dt><code>counters</code></dt>
<dd>An instance of <code>PeerCounters</code>, which counts each CER, CEA, DWR, DWA, DPR,
DPA and other app-routed requests and answers individually.</dd>
<dt><code>statistics</code></dt>
<dd>An instance of <code>PeerStats</code>, which keeps a record of response times, sent 
answer result codes, amount of requests received and rate of requests 
being processed.</dd>
<dt><code>disconnect_reason</code></dt>
<dd>Holds a value that indicates the reason for the most recent peer disconnect.
The value is <code>None</code>, if the peer has so far never been disconnected, or if
the peer is currently in a connected state. The value is one of the 
<code>PEER_DISCONNECT_REASON_*</code> constants and it gets set at the same time as 
the <code>connection</code> attribute gets unset. The reason is reset back to <code>None</code>,
if the peer reconnects and performs a successful CER/CEA exchange.</dd>
</dl>
<p>For a full list of instance attributes, see <a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.Peer"><code>Peer API reference</code></a>.</p>
<h3 id="peer-connection-attributes">Peer connection attributes<a class="headerlink" href="#peer-connection-attributes" title="Permanent link">&para;</a></h3>
<p>Peer connections have several attributes that can be queried and/or altered 
after creation:</p>
<dl>
<dt><code>auth_application_ids</code> and <code>acct_application_ids</code></dt>
<dd>List of authentication and accounting application IDs that have been 
determined as the supported application IDs after a CER/CEA has taken place.</dd>
<dt><code>hop_by_hop_seq</code></dt>
<dd>
<p>The hop-by-hop identifier generator. This must be used every time a new 
request message is to be sent through the peer:</p>
<div class="highlight"><pre><span></span><code><span id="__span-8-1"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-8-2"><span class="kn">from</span> <span class="nn">diameter.node.peer</span> <span class="kn">import</span> <span class="n">PEER_READY_STATES</span>
</span><span id="__span-8-3">
</span><span id="__span-8-4"><span class="n">n</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
</span><span id="__span-8-5"><span class="c1"># just pick any ready peer</span>
</span><span id="__span-8-6"><span class="n">usable_peers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-8-7">    <span class="n">peer</span> <span class="k">for</span> <span class="n">peer</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">peers</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="__span-8-8">    <span class="k">if</span> <span class="n">peer</span><span class="o">.</span><span class="n">conenction</span> <span class="ow">and</span> <span class="n">peer</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">state</span> <span class="ow">in</span> <span class="n">PEER_READY_STATES</span><span class="p">]</span>
</span><span id="__span-8-9"><span class="n">peer</span> <span class="o">=</span> <span class="n">usable_peers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-8-10"><span class="n">m</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">hop_by_hop_identifier</span> <span class="o">=</span> <span class="n">peer</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">hop_by_hop_seq</span><span class="o">.</span><span class="n">next_sequence</span><span class="p">()</span>
</span></code></pre></div>
<p>Note that when working with <a href="../application/">applications</a>, the end-to-end 
identifier will be set automatically for every outgoing request, when 
<a class="autorefs autorefs-internal" href="../../api/node/#diameter.node.node.Node.route_request"><code>Node.route_request</code></a> is used.</p>
</dd>
<dt><code>state</code></dt>
<dd>
<p>The current connection state. One of the <code>"PEER_*"</code> constants within 
<code>diameter.node.peer</code>. A connection will go through state transition
"CONNECTING" -&gt; "CONNECTED" -&gt; "READY" -&gt; "DISCONNECTING" -&gt; "CLOSING" -&gt; "CLOSED"
and will accept requests and answers from other peers and own applications 
when it is "READY". </p>
<p>The "ready" state can have several sub-states. When checking readiness, 
it should be checked that the <code>Peer.connection.state</code> is within 
<code>diameter.peer.PEER_READY_STATES</code>.</p>
</dd>
<dt><code>is_sender</code> and <code>is_receiver</code></dt>
<dd>These read-only attributes indicate the direction the original connection
was established as. A "receiver" connection is one that was established by
a remote peer towards us, a "sender" connection was established by us 
towards a remote peer.</dd>
</dl>
<p>For a full list of connection instance attributes, see 
<a class="autorefs autorefs-internal" href="../../api/peer/#diameter.node.peer.PeerConnection"><code>PeerConnection API reference</code></a>.</p>
<h3 id="sending-messages-through-a-peer">Sending messages through a peer<a class="headerlink" href="#sending-messages-through-a-peer" title="Permanent link">&para;</a></h3>
<p>Normally incoming and outgoing messages are expected to be handled and 
generated by <a href="../application/">applications</a>, however a message can also be 
manually pushed through any connected peer:</p>
<div class="highlight"><pre><span></span><code><span id="__span-9-1"><span class="kn">from</span> <span class="nn">diameter.message.commands.re_auth</span> <span class="kn">import</span> <span class="n">ReAuthRequest</span>
</span><span id="__span-9-2"><span class="kn">from</span> <span class="nn">diameter.node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="__span-9-3"><span class="kn">from</span> <span class="nn">diameter.node.peer</span> <span class="kn">import</span> <span class="n">PEER_READY_STATES</span>
</span><span id="__span-9-4">
</span><span id="__span-9-5"><span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;peername.gy&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">)</span>
</span><span id="__span-9-6"><span class="n">peer</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_peer</span><span class="p">(</span><span class="s2">&quot;aaa://ocs2.gy;transport=sctp&quot;</span><span class="p">,</span> <span class="s2">&quot;realm.net&quot;</span><span class="p">,</span> 
</span><span id="__span-9-7">                     <span class="n">ip_addresses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10.16.0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;10.16.5.8&quot;</span><span class="p">],</span> 
</span><span id="__span-9-8">                     <span class="n">is_persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-9"><span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="__span-9-10">
</span><span id="__span-9-11"><span class="c1"># ideally should wait until connection becomes available; the READY state is not </span>
</span><span id="__span-9-12"><span class="c1"># achieved until CER/CEA has completed, which is likely to take a few seconds</span>
</span><span id="__span-9-13"><span class="k">if</span> <span class="n">peer</span><span class="o">.</span><span class="n">connection</span> <span class="ow">and</span> <span class="n">peer</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">state</span> <span class="ow">in</span> <span class="n">PEER_READY_STATES</span><span class="p">:</span>
</span><span id="__span-9-14">    <span class="n">rar</span> <span class="o">=</span> <span class="n">ReAuthRequest</span><span class="p">()</span>
</span><span id="__span-9-15">    <span class="n">rar</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end_to_end_identifier</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">end_to_end_seq</span><span class="o">.</span><span class="n">next_sequence</span><span class="p">()</span>
</span><span id="__span-9-16">    <span class="n">rar</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">hop_by_hop_identifier</span> <span class="o">=</span> <span class="n">peer</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">hop_by_hop_seq</span><span class="o">.</span><span class="n">next_sequence</span><span class="p">()</span>
</span><span id="__span-9-17">    <span class="n">rar</span><span class="o">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">session_generator</span><span class="o">.</span><span class="n">next_id</span><span class="p">()</span>
</span><span id="__span-9-18">    <span class="c1"># ... set all other required attributes and then send</span>
</span><span id="__span-9-19">    <span class="n">node</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">peer</span><span class="o">.</span><span class="n">connection</span><span class="p">,</span> <span class="n">rar</span><span class="p">)</span>
</span><span id="__span-9-20">
</span><span id="__span-9-21"><span class="n">node</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>